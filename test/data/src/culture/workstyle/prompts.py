from typing import List, Dict, Any

WORKSTYLE_TITLES = {
    "전문가형" : "WORK_SPECIAL",
    "역할중심형" : "WORK_RULEBASE",
    "분석형" : "WORK_ANALYSIS",
    "겸손형" : "WORK_MODESTY",
    "논리형" : "WORK_DATADRIVEN",
    "조율자형" : "WORK_FACILITATE",
    "조력자형" : "WORK_HELP",
    "협력형" : "WORK_COWORK",
    "마당발형" : "WORK_POPULAR",
    "과정주의형" : "WORK_PROCESS",
    "몰입형" : "WORK_ABSORB",
    "일중심사고형" : "WORK_WORKERHOLIC",
    "성취형" : "WORK_AHCIEVE",
    "도전형" : "WORK_CHALLENGE",
    "자기확신형" : "WORK_CONFIDENCE",
    "혁신형" : "WORK_INNOVATE",
    "창조형" : "WORK_CREATIVE",
    "열린사고형" : "WORK_OPEN",
    "직관형" : "WORK_INTUITION",
    "책임형" : "WORK_RESPONSE",
    "열정형" : "WORK_PASSION",
    "솔선수범형" : "WORK_INITIATIVE",
    "스피드형" : "WORK_SPEED",
    "효율형" : "WORK_SMART",
    "신뢰형" : "WORK_TRUST",
    "유니크형" : "WORK_UNIQUE",
    "윤리형" : "WORK_HONEST",
    "끈기형" : "WORK_ENDURANCE",
    "목표지향형" : "WORK_GOAL",
    "긍정형" : "WORK_POSITIVE",
}


WORKSTYLE_INITIAL_MESSAGES = [
    {
        "role": "system",
        "content": ("""
        당신은 뛰어난 인사 기업 분석가입니다. 이제 특정 기업의 공시 자료와 해당 기업의 미래 지향점 및 가치관을 나타내는 16가지 비전 키워드를 기반으로, 기업의 업무스타일에 관한 30가지 항목을 평가해야 합니다.

        평가 시 유의사항:
        1. 업무스타일 상반 관계 고려
        - 업무스타일 항목들은 서로 반대되는 관계에 있으므로, 상반되는 항목들을 동시에 고려합니다.
        - 비전 키워드에서 높은 점수를 받은 항목과 연관된 업무스타일 항목에는 추가 가산점을 부여합니다.
        - 비전 키워드와 업무스타일 점수 간의 일관성을 유지해야 합니다.

        2. 평가 방식 및 점수 산정
        - 각 항목은 5점 만점으로 평가하며, 점수는 소수점 첫째 자리(예: 3.2, 4.5) 단위로 부여합니다.
        - 점수 기준:
            - 5.0: 매우 높음
            - 4.0 ~ 4.9: 높음
            - 3.0 ~ 3.9: 보통
            - 2.0 ~ 2.9: 낮음
            - 1.0 ~ 1.9: 매우 낮음

        3. 점수 분포 조정
        - 전체 항목의 점수 분포는 아래와 같이 조정합니다.
            - 4.6 ~ 5.0: 1~2개
            - 4.0 ~ 4.5: 2~3개
            - 3.5 ~ 3.9: 2~3개
            - 3.0 ~ 3.4: 3~5개
            - 2.0 ~ 2.9: 5~7개
            - 1.0 ~ 1.9: 나머지 항목

        4. 특정 상황에 대한 점수 처리
        - 기업 정보에 명확히 나타나지 않는 항목은 낮은 점수를 부여합니다.
        - 평가할 항목 중 11개만 높은 점수를 부여하고, 나머지 항목은 상대적으로 낮은 점수를 부여합니다.
        - 정보가 불충분하거나 애매한 항목은 1~2점으로 평가합니다.

        5. 평가 근거의 명확한 제시
        - 각 항목별로 부여된 점수에 대해, 객관적인 이유와 근거를 상세히 서술합니다.
        - 단순히 "개선의 여지가 있다"와 같은 모호한 표현은 사용하지 않습니다.

        6. 답변 언어
        - 모든 답변은 반드시 한국어로 작성해야 합니다.
        """
        )
    }
]

WORKSTYLE_CONTEXTS = {
    "전문가형": """
    - 해당 분야에서의 전문성과 지속적인 성장을 추구하는 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '전문성(VISION_SPECIAL)'과 연관성이 있습니다.
    """,
    "역할중심형": """
    - 명확한 역할과 책임(R&R)에 기반한 사고와 행동을 하는 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '문제해결("VISION_SOLVING)'과 연관성이 있습니다.
    """,
    "분석형": """
    - 데이터와 사실에 기반한 의사결정을 선호하는 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '문제해결("VISION_SOLVING)'과 연관성이 있습니다.
    - '업무스타일' 항목들 중에서 '직관형'과는 상반되는 관계입니다.
    """,
    "겸손형": """
    - 서번트 리더십을 실천하며 타인을 배려하는 태도를 평가합니다.
    - '비전 키워드' 항목들 중 '인재(VISION_TALENT)'과 연관성이 있습니다.
    """,
    "논리형": """
    - 감정보다는 논리와 객관성을 중시하는 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '전문성(VISION_SPECIAL)'과 연관성이 있습니다.
    """,
    "조율자형": """
    - 다양한 의견을 조율하고 전체적인 관점에서 판단하는 능력을 평가합니다.
    - '비전 키워드' 항목들 중 '소통(VISION_COMMUNICATION)'과 연관성이 있습니다.
    """,
    "조력자형": """
    - 리더나 동료를 적극적으로 지원하는 팔로워십의 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '상생(VISION_COEXISTENCE)'과 연관성이 있습니다.
    """,
    "협력형": """
    - 타인과의 긍정적 관계 형성 및 협동을 중시하는 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '상생(VISION_COEXISTENCE)'과 연관성이 있습니다.
    """,
    "마당발형": """
    - 적극적으로 다양한 관계를 맺고 소통하는 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '상생(VISION_COEXISTENCE)'과 연관성이 있습니다.
    """,
    "과정주의형": """
    - 결과보다 과정을 중시하는 태도를 평가합니다.
    - '비전 키워드' 항목들 중 '즐거움(VISION_FUN)'과 연관성이 있습니다.
    - '업무스타일' 항목들 중에서 '성취형(WORK_AHCIEVE)', '목표형(WORK_GOAL)'과는 상반되는 관계입니다.
    """,
    "몰입형": """
    - 업무에 대한 집중력과 에너지 투입 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '도전(VISION_CHALLENGE)'과 연관성이 있습니다.
    """,
    "성취형": """
    - 결과 달성을 중시하는 태도를 평가합니다.
    - '비전 키워드' 항목들 중 '성과(VISION_PERFORMANCE)'와 연관성이 있습니다.
    - '업무스타일' 항목들 중에서 '과정주의형(WORK_PROCESS)'과는 상반되는 관계입니다.
    """,
    "책임형": """
    - 맡은 일에 대한 책임감과 주인의식의 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '사회공헌(VISION_CONTRIBUTION)'과 연관성이 있습니다.
    - '업무스타일' 항목들 중에서 '분석형(WORK_ANALYSIS)'과는 상반되는 관계입니다.
    """,
    "혁신형": """
    - 기존 방식을 개선하고 새로운 방법을 추구하는 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '혁신(VISION_INNOVATION)'과 연관성이 있습니다.
    """,
    "창조형": """
    - 독창적이고 새로운 아이디어를 제시하는 능력을 평가합니다.
    - '비전 키워드' 항목들 중 '창조(VISION_CREATIVITY)'과 연관성이 있습니다.
    """,
    "열정형": """
    - 지속적인 내적 동기와 열정의 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '열정(VISION_PASSION)'과 연관성이 있습니다.
    """,
    "끈기형": """
    - 어려움 속에서도 포기하지 않고 지속적으로 노력하는 정도를 평가합니다.
    - '비전 키워드' 항목들 중 '성장(VISION_GROWTH)'과 연관성이 있습니다.
    """,
    "긍정형": """
    - 모든 상황에서 긍정적인 측면을 찾고 발전의 기회로 삼는 태도를 평가합니다.
    - '비전 키워드' 항목들 중 '즐거움(VISION_FUN)'과 연관성이 있습니다.
    """
}

def get_workstyle_messages(i: int, 
                           title: str, 
                           contexts: str, 
                           combined_data: str,
                           vision_results : List[Dict[str, float]]
                           ) -> List[Dict[str, Any]]:
    messages = [
        {
            "role": "system",
            "content": (
                f"{i}번째 업무스타일 항목은 {title}에 대한 평가입니다.\n"
                f"{contexts.strip()}\n\n"
                "응답은 다음 JSON 형식으로 반환되어야 합니다:\n"
                "{\n"
                f"  \"{title}\": {{\n"
                "    \"score\": (float, null),\n"
                "    \"summary\": (string, null)\n"
                "  }\n"
                "}\n"
                "각 필드에 대해:\n"
                "- \"score\": 5점 만점으로 평가된 점수. 데이터가 없으면 null.\n"
                "- \"summary\": 해당 항목에 대한 요약 설명. 데이터가 없으면 null."                
            )
        },
        {
            "role": "user",
            "content": (
                "- 기업 정보는 다음과 같습니다.\n"
                f"{combined_data.strip()}\n\n"
                "- vision 분석 결과는 다음과 같습니다.\n"
                f"{vision_results}"
            )
        }        
    ]

    return messages